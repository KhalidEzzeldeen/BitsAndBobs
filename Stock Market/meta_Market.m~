function output = meta_Market(input)

%% input.trans
%% input.buy / sell_value

trans_record=input.trans_record;
avg_trans=mean(trans_record(:,1));
buy_value=input.buy_value; sell_value=input.sell_value;
N=length(sell_value);
buy_trans=zeros(1,N);sell_trans=zeros(1,N);
for ii=1:length(trans_record)
    buy_trans(trans_record(ii,2))=...
        trans_record(ii,1);
    sell_trans(trans_record(ii,3))=...
        trans_record(ii,1);
end

output.buy_price=min(abs([...
                    (avg_trans+(buy_value-avg_trans).*(rand(1,N)-0.7));...
                    (avg_trans+(buy_trans-avg_trans).*(rand(1,N)-0.7));...
                    (buy_trans+(buy_value-buy_trans).*(rand(1,N)-0.7))...
                    ]))';
output.sell_price=max(abs([...
                    (avg_trans+(avg_trans-sell_value).*(rand(1,N)-0.3));...
                    (avg_trans+(avg_trans-sell_trans).*(rand(1,N)-0.3));...
                    (sell_trans+(sell_value-sell_trans).*(rand(1,N)-0.3))...
                    ]))';
nob=setxor(1:N,trans_record(:,2)); nos=setxor(1:N,trans_record(:,3));
output.buy_price(nob)=max([...
                    (buy_value(nob)<=avg_trans).*...
                    (buy_value(nob).*(ones(1,length(nob))-0.15*rand(1,length(nob))));...
                    (buy_value(nob)>avg_trans).*...
                    (avg_trans+(buy_value(nob)-avg_trans).*(rand(1,length(nob))-0.7))]);
output.sell_price(nos)=min([...
                    (sell_value(nos)>=avg_trans).*...
                    (sell_value(nos).*(ones(1,length(nos))+0.15*rand(1,length(nos))));...
                    (sell_value(nos)<avg_trans).*...
                    (avg_trans+(avg_trans-sell_value(nos)).*(rand(1,length(nos))+0.3))]);
buy_price=output.buy_price'; sell_price=output.sell_price; size(buy_price),size(buy_value),pause
wrong_buy=find(buy_price>buy_value);
wrong_sell=find(sell_price<sell_value);
buy_price(wrong_buy)=buy_value(wrong_buy);
sell_price(wrong_sell)=sell_value(wrong_sell);
output.buy_price=buy_price; output.sell_price=sell_price;