function out = WCalc(TX,X,A,B)


W = [];
K = Wr*(xspan(:,2) - STM*xspan(:,1));
for jk = 1:length(TX)
    index = n*(jk-1);
    Xjk = [X(1+index:2+index)',X(3+index:4+index)'];
    u(jk) = B(TX(jk))'*Xjk'*K;
end
out = {u,K};